<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">


<div class="d-flex flex-row justify-content-center gap-4 my-2">
<button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#changePasswordDiv">
  Change Password
</button>
<button class="btn btn-outline-secondary logoutBtn">Logout</button>
</div>

<div class="modal fade" id="changePasswordDiv" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="staticBackdropLabel">Change Password</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      
      <div class="modal-body changePasswordForm">
        <div class="mt-2" style="width:100%;">
        <label for="name" class="fw-bold">Current Password: </label>
        <input class="form-control" type="password" placeholder="Current Password" id="currentPass" required>
      </div>
        <div class="mt-2" style="width:100%;">
        <label for="name" class="fw-bold">New Password: </label>
        <input class="form-control" type="password" placeholder="New Password" id="newPass1" required>
      </div>
        <div class="mt-2" style="width:100%;">
        <label for="name" class="fw-bold">Confirm New Password: </label>
        <input class="form-control" type="text" placeholder="Confirm New Password" id="newPass2" required>
      </div>
      </div>
      
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-outline-success changePassword">Change</button>
      </div>
    </div>
  </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
<script>
   $('.changePassword').click(function () {
    var currentPass = $('#currentPass').val();
    var newPass1 = $('#newPass1').val();
    var newPass2 = $('#newPass2').val();

    if (currentPass === '' || newPass1 === '' || newPass2 === '') {
      Swal.fire({
        icon: 'error',
        title: 'Empty Fields',
        text: 'Please fill in all fields!'
      });
      return;
    }

    if (newPass1 !== newPass2) {
      Swal.fire({
        icon: 'error',
        title: 'Password Mismatch',
        text: 'New passwords do not match!'
      });
      return;
    }

    $.ajax({
      type: 'POST',
      url: 'change_password.php',
      data: {
        currentPass: currentPass,
        newPass: newPass1
      },
      success: function (cpData) {
        if (cpData.status === 'success') {
          Swal.fire({
            icon: 'success',
            title: cpData.result
          }).then(function () {
            $('#changePasswordDiv').modal('hide');
          });
        } else {
          Swal.fire({
            icon: 'error',
            title: cpData.result
          });
        }
      },
      error: function () {
        Swal.fire({
          icon: 'error',
          title: 'Something Went Wrong!'
        });
      }
    });
  });

  $('.logoutBtn').click(function () {
    Swal.fire({
  title: "Are you sure to logout?",
  icon: "warning",
  showCancelButton: true,
  confirmButtonColor: "#d63030",
  cancelButtonColor: "#767676",
  confirmButtonText: "Yes, Logout!"
}).then((result) => {
  if (result.isConfirmed) {
    window.location.href = "logout.php";
  }
});
  })
</script>